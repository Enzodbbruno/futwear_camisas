<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FutWear - Camisas de Times e Sele√ß√µes</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Helvetica+Neue:wght@400;500;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><defs><linearGradient id='grad1' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%2316a34a;stop-opacity:1' /><stop offset='100%' style='stop-color:%2315803d;stop-opacity:1' /></linearGradient></defs><circle cx='16' cy='16' r='15' fill='url(%23grad1)' stroke='%23fff' stroke-width='2'/><text x='16' y='22' font-family='Arial, sans-serif' font-size='18' font-weight='bold' text-anchor='middle' fill='white'>F</text></svg>">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="header-top-content">
                    <div class="header-logo">
                        <a href="index.html"><span class="logo-text">FUT<span class="logo-accent">WEAR</span></span></a>
                    </div>
                    <nav class="header-nav">
                        <a href="camisas.html" class="nav-link">Novidades</a>
                        <a href="camisas.html?category=clubs" class="nav-link">Times</a>
                        <a href="camisas.html?category=national" class="nav-link">Sele√ß√µes</a>
                        <a href="camisas.html?category=retro" class="nav-link">Retr√¥</a>
                        <a href="camisas.html?discount=true" class="nav-link">Ofertas</a>
                    </nav>
                    <div class="header-actions">
                        <div class="search-container">
                            <button class="search-btn" id="searchToggle" aria-label="Buscar">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <a href="favoritos.html" class="icon-btn" aria-label="Favoritos">
                            <i class="far fa-heart"></i>
                            <span class="badge" id="wishlistBadge">0</span>
                        </a>
                        <a href="carrinho.html" class="icon-btn" aria-label="Carrinho">
                            <i class="fas fa-shopping-bag"></i>
                            <span class="badge" id="cartBadge">0</span>
                        </a>
                        <a href="perfil.html" class="icon-btn auth-avatar" id="profileLink" aria-label="Perfil">
                            <span id="authAvatar"><i class="far fa-user"></i></span>
                        </a>
                        <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Menu">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Search Overlay -->
    <div class="search-box" id="searchBox">
        <div class="container" style="display:flex; align-items:center; gap:1rem; width:100%;">
            <i class="fas fa-search search-icon-label"></i>
            <input type="text" placeholder="Buscar camisas, times, sele√ß√µes..." class="search-input" id="searchInput"
                autocomplete="off">
            <button class="search-close" id="searchClose" aria-label="Fechar busca"><i
                    class="fas fa-times"></i></button>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-content">
            <button class="mobile-menu-close" id="mobileMenuClose"><i class="fas fa-times"></i></button>
            <nav class="mobile-nav">
                <a href="camisas.html" class="mobile-nav-link">Novidades</a>
                <a href="camisas.html?category=clubs" class="mobile-nav-link">Times</a>
                <a href="camisas.html?category=national" class="mobile-nav-link">Sele√ß√µes</a>
                <a href="camisas.html?category=retro" class="mobile-nav-link">Retr√¥</a>
                <a href="camisas.html?discount=true" class="mobile-nav-link">Ofertas</a>
            </nav>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="container">
                <div class="hero-text">
                    <p class="hero-label">Nova Cole√ß√£o 2024</p>
                    <h1 class="hero-title">A ESS√äNCIA DO<br>FUTEBOL</h1>
                    <p class="hero-subtitle">Camisas aut√™nticas dos maiores times e sele√ß√µes do mundo</p>
                    <div class="hero-cta">
                        <a href="camisas.html" class="btn btn-primary">Explorar Cole√ß√£o</a>
                        <a href="camisas.html?discount=true" class="btn btn-secondary">Ver Promo√ß√µes</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero-image">
            <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80"
                alt="FutWear Hero">
        </div>
    </section>

    <!-- Featured Products ‚Äî loaded from Supabase -->
    <section class="section" id="novidades">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Destaques</h2>
                <div class="carousel-controls">
                    <button class="carousel-btn prev" data-carousel="featured"><i
                            class="fas fa-chevron-left"></i></button>
                    <button class="carousel-btn next" data-carousel="featured"><i
                            class="fas fa-chevron-right"></i></button>
                </div>
            </div>
            <div class="carousel" id="featured">
                <div class="carousel-track" id="featuredTrack">
                    <!-- skeleton placeholders -->
                    <div class="product-card" style="pointer-events:none;">
                        <div class="product-image" style="background:#f0f0f0;"></div>
                        <div class="product-info" style="height:70px; background:#f7f7f7; margin-top:8px;"></div>
                    </div>
                    <div class="product-card" style="pointer-events:none;">
                        <div class="product-image" style="background:#f0f0f0;"></div>
                        <div class="product-info" style="height:70px; background:#f7f7f7; margin-top:8px;"></div>
                    </div>
                    <div class="product-card" style="pointer-events:none;">
                        <div class="product-image" style="background:#f0f0f0;"></div>
                        <div class="product-info" style="height:70px; background:#f7f7f7; margin-top:8px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Banner -->
    <section class="banner" id="times">
        <div class="banner-content">
            <div class="container">
                <div class="banner-text">
                    <h2 class="banner-title">TIMES BRASILEIROS</h2>
                    <p class="banner-subtitle">Vista as cores do seu time do cora√ß√£o</p>
                    <a href="camisas.html?category=clubs" class="btn btn-primary">Comprar Agora</a>
                </div>
            </div>
        </div>
        <div class="banner-image">
            <img src="https://images.unsplash.com/photo-1543357480-c60d400e8073?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80"
                alt="Times Brasileiros">
        </div>
    </section>

    <!-- Categories Grid -->
    <section class="section" id="selecoes">
        <div class="container">
            <h2 class="section-title" style="margin-bottom:var(--spacing-2xl);">Categorias</h2>
            <div class="grid grid-2">
                <a href="camisas.html?category=national" class="category-card">
                    <div class="category-image">
                        <img src="https://images.unsplash.com/photo-1614624532983-4fe0333299c7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                            alt="Sele√ß√µes">
                    </div>
                    <div class="category-content">
                        <h3 class="category-title">Sele√ß√µes</h3>
                        <span class="category-link">Comprar <i class="fas fa-arrow-right"></i></span>
                    </div>
                </a>
                <a href="camisas.html?category=clubs" class="category-card">
                    <div class="category-image">
                        <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                            alt="Times Europeus">
                    </div>
                    <div class="category-content">
                        <h3 class="category-title">Times Europeus</h3>
                        <span class="category-link">Comprar <i class="fas fa-arrow-right"></i></span>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- Shipping Info -->
    <section class="section bg-dark">
        <div class="container">
            <h2 class="section-title text-white text-center" style="margin-bottom:var(--spacing-2xl);">Pol√≠tica de Frete
            </h2>
            <div class="grid grid-3">
                <div class="info-card">
                    <div class="info-icon">üì¶</div>
                    <h3 class="info-title">1 Camisa</h3>
                    <p class="info-price">R$ 30,00</p>
                </div>
                <div class="info-card">
                    <div class="info-icon">üì¶üì¶</div>
                    <h3 class="info-title">2 Camisas</h3>
                    <p class="info-price">R$ 20,00</p>
                </div>
                <div class="info-card">
                    <div class="info-icon">üéÅ</div>
                    <h3 class="info-title">3+ Camisas</h3>
                    <p class="info-price highlight">FRETE GR√ÅTIS</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Retro Collection ‚Äî loaded from Supabase -->
    <section class="section" id="retro">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Edi√ß√µes Retr√¥</h2>
                <a href="camisas.html?category=retro" class="link-more">Ver Tudo <i class="fas fa-arrow-right"></i></a>
            </div>
            <div class="grid grid-4" id="retroGrid">
                <!-- loaded from Supabase -->
                <div style="grid-column:1/-1; text-align:center; padding:3rem; color:var(--color-gray-300);">
                    <i class="fas fa-spinner fa-spin" style="font-size:2rem;"></i>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h4 class="footer-title">Encontre uma Loja</h4>
                    <ul class="footer-links">
                        <li><a href="#">Seja um Membro</a></li>
                        <li><a href="#">Cadastre seu E-mail</a></li>
                        <li><a href="#">Envie sua Opini√£o</a></li>
                        <li><a href="#">Cupons para Estudantes</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="footer-title">Obter Ajuda</h4>
                    <ul class="footer-links">
                        <li><a href="#">Status do Pedido</a></li>
                        <li><a href="#">Entrega</a></li>
                        <li><a href="#">Devolu√ß√µes</a></li>
                        <li><a href="#">Contato</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="footer-title">Sobre a FutWear</h4>
                    <ul class="footer-links">
                        <li><a href="#">Not√≠cias</a></li>
                        <li><a href="#">Carreiras</a></li>
                        <li><a href="#">Sustentabilidade</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <div class="social-links">
                        <a href="#" class="social-btn"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-btn"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-btn"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="social-btn"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="footer-bottom-left">
                    <p><i class="fas fa-map-marker-alt"></i> Brasil</p>
                    <p>¬© 2024 FutWear, Inc. Todos os direitos reservados.</p>
                </div>
                <div class="footer-bottom-right">
                    <a href="#">Termos de Uso</a>
                    <a href="#">Pol√≠tica de Privacidade</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script type="module" src="header.js"></script>
    <script type="module">
        import { buscarCamisas, addToCart } from './firebase-hybrid.js';

        function calcPrice(p) {
            const base = parseFloat(p.price) || 0;
            const disc = parseFloat(p.discount) || 0;
            const now = new Date();
            const start = p.promoStart ? new Date(p.promoStart) : null;
            const end = p.promoEnd ? new Date(p.promoEnd) : null;
            const active = disc > 0 && (!start || now >= start) && (!end || now <= end);
            return active ? base * (1 - disc / 100) : base;
        }

        function formatPrice(val) {
            return 'R$ ' + Number(val).toFixed(2).replace('.', ',');
        }

        function productCardHTML(p) {
            const price = calcPrice(p);
            const originalPrice = parseFloat(p.price) || 0;
            const hasDiscount = price < originalPrice;
            const img = p.image || 'https://images.unsplash.com/photo-1614624532983-4fe0333299c7?w=400';
            return `
            <a href="produto.html?id=${p.id}" class="product-card">
                <div class="product-image">
                    <img src="${img}" alt="${p.name}" loading="lazy">
                    <button class="wishlist-btn" onclick="event.preventDefault(); handleWishlist(event, ${JSON.stringify(p).replace(/"/g, '&quot;')})">
                        <i class="far fa-heart"></i>
                    </button>
                    ${hasDiscount ? `<span style="position:absolute;top:12px;left:12px;background:#dc2626;color:#fff;font-size:11px;font-weight:700;padding:3px 8px;border-radius:20px;">-${Math.round(parseFloat(p.discount))}%</span>` : ''}
                </div>
                <div class="product-info">
                    <p class="product-category">${p.team || p.category || ''}</p>
                    <h3 class="product-name">${p.name}</h3>
                    <p class="product-price">
                        ${hasDiscount ? `<small style="text-decoration:line-through;color:#999;font-weight:400;margin-right:6px;">${formatPrice(originalPrice)}</small>` : ''}
                        <span style="color:${hasDiscount ? '#dc2626' : 'inherit'}">${formatPrice(price)}</span>
                    </p>
                </div>
            </a>`;
        }

        window.handleWishlist = function (event, product) {
            event.preventDefault();
            if (window.toggleFavorite) window.toggleFavorite(product);
            const btn = event.currentTarget;
            const icon = btn.querySelector('i');
            icon.classList.toggle('fas');
            icon.classList.toggle('far');
            icon.style.color = icon.classList.contains('fas') ? '#dc2626' : '';
            if (window.updateHeaderBadges) window.updateHeaderBadges();
        };

        async function loadFeatured() {
            const track = document.getElementById('featuredTrack');
            if (!track) return;
            try {
                const products = await buscarCamisas();
                // Pick first 6 for featured
                const featured = products.slice(0, 6);
                if (featured.length === 0) {
                    track.innerHTML = `<div style="padding:2rem;color:var(--color-gray-400);">Nenhum produto encontrado</div>`;
                    return;
                }
                track.innerHTML = featured.map(productCardHTML).join('');
            } catch (e) {
                console.error('Erro ao carregar destaques:', e);
                track.innerHTML = `<div style="padding:2rem;color:var(--color-gray-400);">Erro ao carregar produtos. Tente novamente.</div>`;
            }
        }

        async function loadRetro() {
            const grid = document.getElementById('retroGrid');
            if (!grid) return;
            try {
                const products = await buscarCamisas();
                // Filter retro or pick last 4
                const retro = products.filter(p =>
                    (p.category || '').toLowerCase().includes('retro') ||
                    (p.category || '').toLowerCase().includes('retr√¥') ||
                    (p.name || '').toLowerCase().includes('retro') ||
                    (p.name || '').toLowerCase().includes('retr√¥')
                ).slice(0, 4);

                const toShow = retro.length > 0 ? retro : products.slice(-4).reverse();

                if (toShow.length === 0) {
                    grid.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:2rem;color:var(--color-gray-400);">Nenhum produto retr√¥ encontrado</div>`;
                    return;
                }
                grid.innerHTML = toShow.map(productCardHTML).join('');
            } catch (e) {
                grid.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:2rem;color:var(--color-gray-400);">Erro ao carregar produtos.</div>`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadFeatured();
            loadRetro();
        });
    </script>
</body>

</html>