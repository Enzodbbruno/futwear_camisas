<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meus Favoritos - FutWear</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Helvetica+Neue:wght@400;500;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><defs><linearGradient id='grad1' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%2316a34a;stop-opacity:1' /><stop offset='100%' style='stop-color:%2315803d;stop-opacity:1' /></linearGradient></defs><circle cx='16' cy='16' r='15' fill='url(%23grad1)' stroke='%23fff' stroke-width='2'/><text x='16' y='22' font-family='Arial, sans-serif' font-size='18' font-weight='bold' text-anchor='middle' fill='white'>F</text></svg>">
    <link rel="stylesheet" href="styles.css">
    <style>
        .favorites-page {
            padding: var(--spacing-3xl) 0;
            min-height: 60vh;
        }

        .favorites-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-2xl);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .favorites-header h1 {
            font-size: var(--font-size-3xl);
            font-weight: 700;
        }

        .favorites-header h1 i {
            color: #dc2626;
            margin-right: var(--spacing-sm);
        }

        .favorites-count {
            font-size: var(--font-size-base);
            color: var(--color-gray-400);
        }

        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-xl) var(--spacing-md);
        }

        .fav-card {
            border: 1px solid var(--color-gray-100);
            border-radius: 4px;
            overflow: hidden;
            background: var(--color-white);
            transition: transform var(--transition-base), box-shadow var(--transition-base);
        }

        .fav-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, .1);
        }

        .fav-card-img {
            position: relative;
            aspect-ratio: 1;
            overflow: hidden;
        }

        .fav-card-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-slow);
        }

        .fav-card:hover .fav-card-img img {
            transform: scale(1.06);
        }

        .fav-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: #dc2626;
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .fav-remove {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 36px;
            height: 36px;
            background: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #dc2626;
            font-size: var(--font-size-base);
            transition: all var(--transition-fast);
            box-shadow: 0 2px 8px rgba(0, 0, 0, .15);
        }

        .fav-remove:hover {
            background: #dc2626;
            color: white;
        }

        .fav-card-body {
            padding: var(--spacing-lg);
        }

        .fav-category {
            font-size: var(--font-size-sm);
            color: var(--color-gray-400);
            margin-bottom: 4px;
        }

        .fav-name {
            font-size: var(--font-size-base);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
        }

        .fav-price {
            font-size: var(--font-size-lg);
            font-weight: 700;
            color: var(--color-black);
            margin-bottom: var(--spacing-md);
        }

        .fav-installment {
            font-size: var(--font-size-xs);
            color: var(--color-gray-400);
        }

        .fav-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        .btn-add-cart {
            flex: 1;
            padding: 10px;
            background: var(--color-black);
            color: var(--color-white);
            border: none;
            border-radius: 4px;
            font-size: var(--font-size-sm);
            font-weight: 600;
            cursor: pointer;
            font-family: var(--font-primary);
            transition: opacity var(--transition-fast);
        }

        .btn-add-cart:hover {
            opacity: .85;
        }

        .btn-fav-remove {
            padding: 10px 14px;
            background: var(--color-white);
            border: 1px solid #fecaca;
            border-radius: 4px;
            color: #dc2626;
            cursor: pointer;
            font-size: var(--font-size-sm);
            transition: all var(--transition-fast);
        }

        .btn-fav-remove:hover {
            background: #fef2f2;
        }

        .favorites-empty {
            text-align: center;
            padding: 80px var(--spacing-xl);
        }

        .favorites-empty i {
            font-size: 5rem;
            color: var(--color-gray-200);
            display: block;
            margin-bottom: var(--spacing-xl);
        }

        .favorites-empty h2 {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            margin-bottom: var(--spacing-md);
        }

        .favorites-empty p {
            color: var(--color-gray-400);
            margin-bottom: var(--spacing-2xl);
        }

        .favorites-empty a {
            display: inline-block;
            background: var(--color-black);
            color: var(--color-white);
            padding: 14px 32px;
            border-radius: 30px;
            font-weight: 600;
            text-decoration: none;
        }

        .favorites-loading {
            text-align: center;
            padding: 80px var(--spacing-xl);
            color: var(--color-gray-400);
        }

        @media (max-width: 960px) {
            .favorites-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .favorites-header h1 {
                font-size: var(--font-size-2xl);
            }

            .favorites-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="header-top-content">
                    <div class="header-logo">
                        <a href="index.html"><span class="logo-text">FUT<span class="logo-accent">WEAR</span></span></a>
                    </div>
                    <nav class="header-nav">
                        <a href="camisas.html" class="nav-link">Novidades</a>
                        <a href="camisas.html?category=clubs" class="nav-link">Times</a>
                        <a href="camisas.html?category=national" class="nav-link">Seleções</a>
                        <a href="camisas.html?category=retro" class="nav-link">Retrô</a>
                        <a href="camisas.html?discount=true" class="nav-link">Ofertas</a>
                    </nav>
                    <div class="header-actions">
                        <div class="search-container">
                            <button class="search-btn" id="searchToggle" aria-label="Buscar"><i
                                    class="fas fa-search"></i></button>
                        </div>
                        <a href="favoritos.html" class="icon-btn" aria-label="Favoritos">
                            <i class="fas fa-heart" style="color:#dc2626;"></i>
                            <span class="badge" id="wishlistBadge">0</span>
                        </a>
                        <a href="carrinho.html" class="icon-btn" aria-label="Carrinho">
                            <i class="fas fa-shopping-bag"></i>
                            <span class="badge" id="cartBadge">0</span>
                        </a>
                        <a href="perfil.html" class="icon-btn auth-avatar" id="profileLink" aria-label="Perfil">
                            <span id="authAvatar"><i class="far fa-user"></i></span>
                        </a>
                        <button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Search Overlay -->
    <div class="search-box" id="searchBox">
        <div class="search-box-inner">
            <button class="search-close" id="searchClose" aria-label="Fechar busca"><i
                    class="fas fa-times"></i></button>
            <input type="text" placeholder="Pesquisar times, seleções, camisas..." class="search-input" id="searchInput"
                autocomplete="off">
            <div class="search-hint">
                <span>Sugestões:</span>
                <a href="camisas.html?category=clubs">Times</a>
                <a href="camisas.html?category=national">Seleções</a>
                <a href="camisas.html?category=retro">Retrô</a>
                <a href="camisas.html?discount=true">Ofertas</a>
            </div>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-content">
            <button class="mobile-menu-close" id="mobileMenuClose"><i class="fas fa-times"></i></button>
            <nav class="mobile-nav">
                <a href="camisas.html" class="mobile-nav-link">Novidades</a>
                <a href="camisas.html?category=clubs" class="mobile-nav-link">Times</a>
                <a href="camisas.html?category=national" class="mobile-nav-link">Seleções</a>
                <a href="camisas.html?category=retro" class="mobile-nav-link">Retrô</a>
                <a href="camisas.html?discount=true" class="mobile-nav-link">Ofertas</a>
            </nav>
        </div>
    </div>

    <!-- Favorites Page -->
    <main class="favorites-page">
        <div class="container">
            <div class="favorites-header">
                <h1><i class="fas fa-heart"></i>Meus Favoritos</h1>
                <span class="favorites-count" id="favoritesCount">Carregando...</span>
            </div>

            <!-- Loading State -->
            <div id="loadingState" class="favorites-loading">
                <i class="fas fa-spinner fa-spin"
                    style="font-size:2.5rem; display:block; margin-bottom:1rem; color:#ccc;"></i>
                <p>Carregando seus favoritos...</p>
            </div>

            <!-- Favorites Grid -->
            <div class="favorites-grid" id="favoritesGrid" style="display:none;"></div>

            <!-- Empty State -->
            <div id="emptyState" class="favorites-empty" style="display:none;">
                <i class="fas fa-heart-broken"></i>
                <h2>Nenhum favorito ainda</h2>
                <p>Adicione camisas aos seus favoritos para vê-las aqui!</p>
                <a href="camisas.html"><i class="fas fa-shopping-bag" style="margin-right:.5rem;"></i>Explorar
                    Camisas</a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h4 class="footer-title">Encontre uma Loja</h4>
                    <ul class="footer-links">
                        <li><a href="#">Seja um Membro</a></li>
                        <li><a href="#">Cadastre seu E-mail</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="footer-title">Obter Ajuda</h4>
                    <ul class="footer-links">
                        <li><a href="#">Status do Pedido</a></li>
                        <li><a href="#">Devoluções</a></li>
                        <li><a href="#">Contato</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="footer-title">Sobre a FutWear</h4>
                    <ul class="footer-links">
                        <li><a href="#">Notícias</a></li>
                        <li><a href="#">Carreiras</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <div class="social-links">
                        <a href="#" class="social-btn"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-btn"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-btn"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="social-btn"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="footer-bottom-left">
                    <p><i class="fas fa-map-marker-alt"></i> Brasil</p>
                    <p>© 2024 FutWear, Inc. Todos os direitos reservados.</p>
                </div>
                <div class="footer-bottom-right">
                    <a href="#">Termos de Uso</a>
                    <a href="#">Política de Privacidade</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script src="header.js"></script>
    <script type="module">
        import { addToCart } from './firebase-hybrid.js';
        import './favorites-system.js';

        window.addToCart = addToCart;

        const loadingState = document.getElementById('loadingState');
        const favoritesGrid = document.getElementById('favoritesGrid');
        const emptyState = document.getElementById('emptyState');
        const favoritesCount = document.getElementById('favoritesCount');

        window.addFavoriteToCart = function (index) {
            const favorites = window.getFavorites();
            const product = favorites[index];
            if (product) { addToCart(product); }
        };

        window.removeFromFavorites = function (productId) {
            const favorites = window.getFavorites();
            const product = favorites.find(fav => fav.id === productId);
            if (product) { window.toggleFavorite(product); loadFavorites(); }
        };

        async function loadFavorites() {
            try {
                if (window.favoritesSystem) await window.favoritesSystem.init();
                const favorites = window.getFavorites ? window.getFavorites() : [];
                const count = favorites.length;
                favoritesCount.textContent = `${count} ${count === 1 ? 'favorito' : 'favoritos'}`;

                const wishlistBadge = document.getElementById('wishlistBadge');
                if (wishlistBadge) { wishlistBadge.textContent = count; }

                if (favorites.length === 0) { showEmptyState(); return; }

                loadingState.style.display = 'none';
                favoritesGrid.style.display = 'grid';
                emptyState.style.display = 'none';
                renderFavorites(favorites);
            } catch (error) {
                console.error('Erro ao carregar favoritos:', error);
                showEmptyState();
            }
        }

        function renderFavorites(favorites) {
            favoritesGrid.innerHTML = favorites.map((product, index) => `
                <div class="fav-card">
                    <div class="fav-card-img">
                        <img src="${product.image || 'https://images.unsplash.com/photo-1614624532983-4fe0333299c7?w=400'}" alt="${product.name}">
                        <span class="fav-badge"><i class="fas fa-heart"></i> Favorito</span>
                        <button class="fav-remove" onclick="removeFromFavorites('${product.id}')" title="Remover dos favoritos"><i class="fas fa-heart"></i></button>
                    </div>
                    <div class="fav-card-body">
                        <p class="fav-category">${product.team || product.category || ''}</p>
                        <h3 class="fav-name">${product.name}</h3>
                        <p class="fav-price">R$ ${Number(product.price).toFixed(2).replace('.', ',')}<br>
                            <span class="fav-installment">ou 3x de R$ ${(Number(product.price) / 3).toFixed(2).replace('.', ',')}</span>
                        </p>
                        <div class="fav-actions">
                            <button class="btn-add-cart" onclick="addFavoriteToCart(${index})">
                                <i class="fas fa-shopping-cart" style="margin-right:.4rem;"></i>Comprar
                            </button>
                            <button class="btn-fav-remove" onclick="removeFromFavorites('${product.id}')">
                                <i class="fas fa-heart-broken"></i>
                            </button>
                        </div>
                    </div>
                </div>`).join('');
        }

        function showEmptyState() {
            loadingState.style.display = 'none';
            favoritesGrid.style.display = 'none';
            emptyState.style.display = 'block';
            favoritesCount.textContent = '0 favoritos';
        }

        function updateCartBadge() {
            try {
                const cart = JSON.parse(localStorage.getItem('cart') || '[]');
                const count = cart.reduce((s, i) => s + (i.quantity || 1), 0);
                const badge = document.getElementById('cartBadge');
                if (badge) badge.textContent = count;
            } catch (e) { }
        }

        document.addEventListener('DOMContentLoaded', () => { loadFavorites(); updateCartBadge(); });
        window.addEventListener('favoritesUpdated', () => { loadFavorites(); });
    </script>
</body>

</html>