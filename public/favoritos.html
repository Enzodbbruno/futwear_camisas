<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FutWear - Meus Favoritos</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><defs><linearGradient id='grad1' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%2316a34a;stop-opacity:1' /><stop offset='100%' style='stop-color:%2315803d;stop-opacity:1' /></linearGradient></defs><circle cx='16' cy='16' r='15' fill='url(%23grad1)' stroke='%23fff' stroke-width='2'/><text x='16' y='22' font-family='Arial, sans-serif' font-size='18' font-weight='bold' text-anchor='middle' fill='white'>F</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/premium-header.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Teko:wght@500;700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <style>
        /* ... existing styles ... */
    </style>
</head>

<body class="font-sans bg-gray-50 text-gray-900" style="padding-top: 70px;">
    <!-- Premium Glass Header -->
    <header class="header-glass" id="main-header">
        <div class="header-container">
            <!-- Mobile Toggle -->
            <button class="mobile-toggle">
                <i class="fas fa-bars"></i>
            </button>

            <!-- Logo -->
            <a href="index.html" class="logo-container">
                <span class="logo-text">FUT<span class="logo-accent">WEAR</span></span>
            </a>

            <!-- Desktop Nav -->
            <nav class="nav-menu">
                <a href="index.html" class="nav-link">IN√çCIO</a>
                <a href="camisas.html" class="nav-link">COLE√á√ïES</a>
                <a href="camisas.html?category=clubs" class="nav-link">TIMES</a>
                <a href="camisas.html?category=national" class="nav-link">SELE√á√ïES</a>
                <a href="#" class="nav-link">OFERTAS</a>
            </nav>

            <!-- Actions & Search -->
            <div class="nav-actions">
                <!-- Search Bar (Desktop) -->
                <div class="search-bar-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" placeholder="Buscar camisas..." class="search-input" id="desktopSearchInput">
                </div>

                <!-- Mobile Search Button -->
                <button class="icon-btn mobile-search-btn" onclick="toggleSearch()">
                    <i class="fas fa-search"></i>
                </button>

                <a href="favoritos.html" class="icon-btn relative">
                    <i class="fas fa-heart"></i>
                    <span id="wishlist-count" class="cart-badge hidden">0</span>
                </a>
                <a href="carrinho.html" class="icon-btn relative">
                    <i class="fas fa-shopping-bag"></i>
                    <span id="cart-count" class="cart-badge">0</span>
                </a>
                <a href="perfil.html" class="icon-btn">
                    <i class="fas fa-user"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pt-20">
        <!-- Page Header -->
        <div class="bg-gradient-to-r from-red-500 to-pink-500 text-white py-16">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-5xl font-bold mb-4 animate-slide-up">
                    <i class="fas fa-heart mr-4 animate-bounce"></i>
                    Meus Favoritos
                </h1>
                <p class="text-xl text-red-100 animate-fade-in" style="animation-delay: 0.3s;">
                    Suas camisas favoritas em um s√≥ lugar
                </p>
            </div>
        </div>

        <!-- Favorites Section -->
        <div class="py-12 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="glass-card-strong rounded-2xl shadow-enhanced-lg p-8 animate-scale-in">
                    <div class="flex justify-between items-center mb-8">
                        <h2 class="text-3xl font-bold text-gradient">
                            <i class="fas fa-heart text-red-500 mr-3"></i>
                            Produtos Favoritos
                        </h2>
                        <div id="favoritesCount" class="text-gray-600 text-lg font-semibold animate-fade-in">
                            Carregando...
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="loadingState" class="text-center py-16">
                        <i class="fas fa-spinner fa-spin text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600">Carregando seus favoritos...</p>
                    </div>

                    <!-- Favorites Grid -->
                    <div id="favoritesGrid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 hidden">
                        <!-- Favorites will be inserted here -->
                    </div>

                    <!-- Empty State -->
                    <div id="emptyState" class="text-center py-16 hidden">
                        <i class="fas fa-heart-broken text-8xl text-gray-300 mb-6 animate-bounce"></i>
                        <h3 class="text-2xl font-bold text-gray-600 mb-4">Nenhum favorito ainda</h3>
                        <p class="text-gray-500 text-lg mb-6">Adicione camisas aos seus favoritos para v√™-las aqui!</p>
                        <a href="camisas.html"
                            class="btn-primary text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300 hover:scale-105 inline-block">
                            <i class="fas fa-shopping-bag mr-2"></i>
                            Explorar Camisas
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script type="module">
        import { addToCart } from './firebase-hybrid.js';
        import './favorites-system.js';

        // Make addToCart globally available
        window.addToCart = addToCart;

        // DOM Elements
        const loadingState = document.getElementById('loadingState');
        const favoritesGrid = document.getElementById('favoritesGrid');
        const emptyState = document.getElementById('emptyState');
        const favoritesCount = document.getElementById('favoritesCount');
        const wishlistCount = document.getElementById('wishlistCount');

        // Fun√ß√£o para adicionar produto por √≠ndice
        window.addFavoriteToCart = function (index) {
            console.log('üõí Adicionando favorito ao carrinho:', index);
            const favorites = window.getFavorites();
            const product = favorites[index];
            if (product) {
                console.log('‚úÖ Produto encontrado:', product);
                addToCart(product);
            } else {
                console.error('‚ùå Produto n√£o encontrado no √≠ndice:', index);
            }
        };

        // Fun√ß√£o para remover dos favoritos
        window.removeFromFavorites = function (productId) {
            console.log('‚ùå Removendo dos favoritos:', productId);
            const favorites = window.getFavorites();
            const product = favorites.find(fav => fav.id === productId);
            if (product) {
                window.toggleFavorite(product);
                loadFavorites(); // Recarrega a lista
            }
        };

        // Fun√ß√£o para carregar favoritos
        function loadFavorites() {
            console.log('‚ù§Ô∏è Carregando favoritos...');

            try {
                const favorites = window.getFavorites();
                console.log('üì¶ Favoritos carregados:', favorites);

                // Atualiza contador
                const count = typeof window.getFavoritesCount === 'function' ? window.getFavoritesCount() : favorites.length;
                favoritesCount.textContent = `${count} favoritos`;
                if (wishlistCount) {
                    wishlistCount.textContent = String(count);
                    wishlistCount.classList.remove('hidden');
                    wishlistCount.setAttribute('aria-label', `Favoritos: ${count}`);
                    wishlistCount.setAttribute('title', `Favoritos: ${count}`);
                }

                if (favorites.length === 0) {
                    showEmptyState();
                    return;
                }

                // Esconde loading e mostra favoritos
                loadingState.classList.add('hidden');
                favoritesGrid.classList.remove('hidden');
                emptyState.classList.add('hidden');

                renderFavorites(favorites);

            } catch (error) {
                console.error('‚ùå Erro ao carregar favoritos:', error);
                showEmptyState();
            }
        }

        // Fun√ß√£o para renderizar favoritos
        function renderFavorites(favorites) {
            console.log('üé® Renderizando favoritos...');

            favoritesGrid.innerHTML = favorites.map((product, index) => `
                <div class="product-card rounded-2xl overflow-hidden animate-fade-in group" style="animation-delay: ${index * 0.1}s;">
                    <div class="relative overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-56 object-cover transition-all duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                        <button onclick="removeFromFavorites('${product.id}')" class="absolute top-4 right-4 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center text-red-500 hover:bg-red-500 hover:text-white transition-all duration-300 hover:scale-110 shadow-lg">
                            <i class="fas fa-heart"></i>
                        </button>
                        <span class="absolute top-4 left-4 text-xs bg-red-100 text-red-600 px-3 py-1 rounded-full font-semibold shadow-sm">
                            <i class="fas fa-heart mr-1"></i>Favorito
                        </span>
                        <div class="absolute bottom-4 left-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            <div class="bg-white/90 backdrop-blur-sm rounded-lg p-2">
                                <p class="text-xs text-gray-600 text-center">Clique para ver detalhes</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-6 bg-gradient-to-b from-white to-gray-50">
                        <div class="mb-4">
                            <h3 class="font-bold text-gray-800 text-lg mb-2 line-clamp-2">${product.name}</h3>
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full font-medium">${product.type || 'Produto'}</span>
                                <span class="text-xs bg-purple-100 text-purple-600 px-2 py-1 rounded-full font-medium">${product.league || 'N/A'}</span>
                            </div>
                            <p class="text-sm text-gray-600 mb-3">
                                <i class="fas fa-users mr-1"></i>
                                <span class="font-semibold text-gray-800">${product.team || 'N/A'}</span>
                            </p>
                        </div>
                        
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex flex-col">
                                <span class="text-2xl font-bold text-gray-900">R$ ${product.price.toFixed(2).replace('.', ',')}</span>
                                <span class="text-xs text-gray-500">ou 3x de R$ ${(product.price / 3).toFixed(2).replace('.', ',')}</span>
                            </div>
                            <div class="text-right">
                                <div class="flex items-center text-yellow-500">
                                    <i class="fas fa-star text-sm"></i>
                                    <i class="fas fa-star text-sm"></i>
                                    <i class="fas fa-star text-sm"></i>
                                    <i class="fas fa-star text-sm"></i>
                                    <i class="fas fa-star text-sm"></i>
                                    <span class="text-xs text-gray-500 ml-1">(4.8)</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex gap-2">
                            <button onclick="addFavoriteToCart(${index})" class="flex-1 btn-primary text-white py-3 px-4 rounded-xl font-semibold transition-all duration-300 hover:scale-105 flex items-center justify-center shadow-lg">
                                <i class="fas fa-shopping-cart mr-2"></i>Comprar
                            </button>
                            <button onclick="removeFromFavorites('${product.id}')" class="px-4 py-3 bg-red-100 hover:bg-red-200 text-red-600 rounded-xl transition-all duration-300 hover:scale-105 flex items-center justify-center">
                                <i class="fas fa-heart-broken"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            console.log('‚úÖ Favoritos renderizados com sucesso!');
        }

        // Fun√ß√£o para mostrar estado vazio
        function showEmptyState() {
            console.log('üì≠ Mostrando estado vazio');
            loadingState.classList.add('hidden');
            favoritesGrid.classList.add('hidden');
            emptyState.classList.remove('hidden');
            favoritesCount.textContent = '0 favoritos';
            if (wishlistCount) {
                wishlistCount.textContent = '0';
                wishlistCount.classList.remove('hidden');
                wishlistCount.setAttribute('aria-label', 'Favoritos: 0');
                wishlistCount.setAttribute('title', 'Favoritos: 0');
            }
        }

        // Fun√ß√£o para atualizar √≠cone do carrinho
        function updateCartIcon() {
            try {
                const cart = JSON.parse(localStorage.getItem('cart') || '[]');
                const totalItems = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
                const cartCount = document.getElementById('cartCount');
                if (cartCount) {
                    cartCount.textContent = totalItems;
                    cartCount.classList.toggle('hidden', totalItems === 0);
                }
            } catch (error) {
                console.warn('Erro ao atualizar √≠cone do carrinho:', error);
            }
        }

        // Fun√ß√£o de busca (placeholder)
        window.toggleSearch = function () {
            console.log('üîç Toggle search');
            alert('Funcionalidade de busca ser√° implementada!');
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Iniciando p√°gina de favoritos...');
            loadFavorites();
            updateCartIcon();
        });

        // Escuta mudan√ßas nos favoritos
        window.addEventListener('favoritesUpdated', () => {
            console.log('üîÑ Favoritos atualizados, recarregando...');
            loadFavorites();
        });
    </script>

    <!-- Adidas Style Header Script Removed -->
    <script src="js/header.js"></script>
</body>

</html>